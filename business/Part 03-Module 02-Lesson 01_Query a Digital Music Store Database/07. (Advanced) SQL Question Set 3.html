<!-- udacimak v1.3.0 -->
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>(Advanced) SQL: Question Set 3</title>
  <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
  <link rel="stylesheet" href="../assets/css/plyr.css">
  <link rel="stylesheet" href="../assets/css/katex.min.css">
  <link rel="stylesheet" href="../assets/css/jquery.mCustomScrollbar.min.css">
  <link rel="stylesheet" href="../assets/css/styles.css">
  <link rel="shortcut icon" type="image/png" href="../assets/img/udacimak.png" />
</head>

<body>
  <div class="wrapper">
    <nav id="sidebar">
  <div class="sidebar-header">
    <h3>Query a Digital Music Store Database</h3>
  </div>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled components">
    <li class="">
      <a href="01. Project Introduction.html">01. Project Introduction</a>
    </li>
    <li class="">
      <a href="02. Set Up the Database.html">02. Set Up the Database</a>
    </li>
    <li class="">
      <a href="03. Checking Setup.html">03. Checking Setup</a>
    </li>
    <li class="">
      <a href="04. Schema Match.html">04. Schema Match</a>
    </li>
    <li class="">
      <a href="05. SQL Question Set 1.html">05. SQL: Question Set 1</a>
    </li>
    <li class="">
      <a href="06. SQL Question Set 2.html">06. SQL: Question Set 2</a>
    </li>
    <li class="">
      <a href="07. (Advanced) SQL Question Set 3.html">07. (Advanced) SQL: Question Set 3</a>
    </li>
    <li class="">
      <a href="08. Different Date Functions for the Project.html">08. Different Date Functions for the Project</a>
    </li>
    <li class="">
      <a href="09. Project Submission - IMPORTANT.html">09. Project Submission - IMPORTANT</a>
    </li>
    <li class="">
      <a href="10. Common Mistakes.html">10. Common Mistakes</a>
    </li>
    <li class="">
      <a href="Project Description - SQL Project.html">Project Description - SQL Project</a>
    </li>
    <li class="">
      <a href="Project Rubric - SQL Project.html">Project Rubric - SQL Project</a>
    </li>
  </ul>

  <ul class="sidebar-list list-unstyled CTAs">
    <li>
      <a href="../index.html" class="article">Back to Home</a>
    </li>
  </ul>
</nav>

    <div id="content">
      <header class="container-fluild header">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <div class="align-items-middle">
                <button type="button" id="sidebarCollapse" class="btn btn-toggle-sidebar">
                  <div></div>
                  <div></div>
                  <div></div>
                </button>

                <h1 style="display: inline-block">07. (Advanced) SQL: Question Set 3</h1>
              </div>
            </div>
          </div>
        </div>
      </header>

      <main class="container">
        <div class="row">
          <div class="col-12">
            <div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="advanced-sql">Advanced SQL</h4>
<p>To solve the questions here, you will need to write a query that extends beyond the content covered in these lessons.  These questions are simply here to show you that there are extensions of the material we have already covered, but you definitely have the building blocks to tackle these tougher topics! <strong>These questions are given as additional material to challenge you!</strong>  Each of the below require the tools you are already familiar with, but they also use a new method known as a <a href="https://community.modeanalytics.com/sql/tutorial/sql-subqueries/" target="_blank"><strong>SUBQUERY</strong></a>. </p>
<h3 id="question-1">Question 1</h3>
<p>We want to find out the most popular music Genre for each country.  We determine the most popular genre as the genre with the highest amount of purchases.  Write a query that returns each country along with the top Genre.  For countries where the maximum number of purchases is shared return all Genres.</p>
<p>For this query, you will need to use the <strong>Invoice</strong>, <strong>InvoiceLine</strong>, <strong>Customer</strong>, <strong>Track</strong>, and <strong>Genre</strong> tables.  </p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="check-your-solution">Check Your Solution</h4>
<p>Though there are only 24 countries, your query should return 25 rows.  The first 11 rows are shown in the image below.  Notice that the Argentina has 2 Genres that share the maximum.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screen-shot-2017-07-04-at-4.59.48-pm.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="question-2">Question 2</h4>
<p>Return all the track names that have a song length longer than the average song length.  Though you could perform this with two queries.  Imagine you wanted your query to update based on when new data is put in the database.  Therefore, you do not want to hard code the average into your query.  You only need the <strong>Track</strong> table to complete this query.</p>
<p>Return the <strong>Name</strong> and <strong>Milliseconds</strong> for each track. Order by the song length with the longest songs listed first.  </p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="check-your-solution">Check Your Solution</h4>
<p>Below is an image of what the top ten rows of your table should look like.  There should only be <strong>494</strong> of the 3503 tracks in your table.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screen-shot-2017-07-04-at-12.28.35-pm.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="question-3">Question 3</h4>
<p>Write a query that determines the customer that has spent the most on music for each country.  Write a query that returns the country along with the top customer and how much they spent.  For countries where the top amount spent is shared, provide all customers who spent this amount.</p>
<p>You should only need to use the <strong>Customer</strong> and <strong>Invoice</strong> tables.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <h4 id="check-your-solution">Check Your Solution</h4>
<p>Though there are only 24 countries, your query should return 25 rows.  The <strong>last</strong> 11 rows are shown in the image below.  Notice that the United Kingdom has 2 customers that share the maximum.</p>
</div>

</div>
<div class="divider"></div><div class="ud-atom">
  <h3></h3>
  <div>
  <figure class="figure">
    <img src="img/screen-shot-2017-07-04-at-4.34.40-pm.png" alt="" class="img img-fluid">
    <figcaption class="figure-caption">
      
    </figcaption>
  </figure>
</div>


</div>
<div class="divider"></div>
          </div>

          <div class="col-12">
            <p class="text-right">
              <a href="08. Different Date Functions for the Project.html" class="btn btn-outline-primary mt-4" role="button">Next Concept</a>
            </p>
          </div>
        </div>
      </main>

      <footer class="footer">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <p class="text-center">
                <a href="https://github.com/udacimak/udacimak#readme" target="_blank">udacimak v1.3.0</a>
              </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>


  <script src="../assets/js/jquery-3.3.1.min.js"></script>
  <script src="../assets/js/plyr.polyfilled.min.js"></script>
  <script src="../assets/js/bootstrap.min.js"></script>
  <script src="../assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="../assets/js/katex.min.js"></script>
  <script>
    // Initialize Plyr video players
    const players = Array.from(document.querySelectorAll('video')).map(p => new Plyr(p));

    // render math equations
    let elMath = document.getElementsByClassName('mathquill');
    for (let i = 0, len = elMath.length; i < len; i += 1) {
      const el = elMath[i];

      katex.render(el.textContent, el, {
        throwOnError: false
      });
    }

    // this hack will make sure Bootstrap tabs work when using Handlebars
    if ($('#question-tabs').length && $('#user-answer-tabs').length) {
      $("#question-tabs a.nav-link").on('click', function () {
        $("#question-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
      $("#user-answer-tabs a.nav-link").on('click', function () {
        $("#user-answer-tab-contents .tab-pane").hide();
        $($(this).attr("href")).show();
      });
    } else {
      $("a.nav-link").on('click', function () {
        $(".tab-pane").hide();
        $($(this).attr("href")).show();
      });
    }

    // side bar events
    $(document).ready(function () {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });

      $('#sidebarCollapse').on('click', function () {
        $('#sidebar, #content').toggleClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });

      // scroll to first video on page loading
      if ($('video').length) {
        $('html,body').animate({ scrollTop: $('div.plyr').prev().offset().top});
      }

      // auto play first video: this may not work with chrome/safari due to autoplay policy
      if (players && players.length > 0) {
        players[0].play();
      }

      // scroll sidebar to current concept
      const currentInSideBar = $( "ul.sidebar-list.components li a:contains('07. (Advanced) SQL: Question Set 3')" )
      currentInSideBar.css( "text-decoration", "underline" );
      $("#sidebar").mCustomScrollbar('scrollTo', currentInSideBar);
    });
  </script>
</body>

</html>
